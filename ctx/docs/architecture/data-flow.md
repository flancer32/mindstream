# Mindstream — Architecture Data Flow

Path: `ctx/docs/architecture/data-flow.md`

## Назначение

Документ фиксирует архитектурную модель потоков данных в MVP Mindstream: какие классы потоков существуют, между какими архитектурными контурами они допустимы и какие инварианты определяют их направленность и допустимость.

Документ задаёт общую рамку потоков и служит точкой входа для документов детализации. Он не описывает конкретные шаги обработки, форматы данных, алгоритмы или реализации.

---

## Роль документа в архитектуре

`data-flow.md` не является продолжением `architecture/overview.md` и не детализирует архитектурные контуры.

Если `architecture/overview.md` отвечает на вопрос **«какие архитектурные контуры существуют и за что они отвечают»**, то `data-flow.md` фиксирует **«какие типы потоков между ними допустимы и какие — запрещены»**.

Документ описывает потоки как архитектурные факты, а не как последовательности операций.

---

## Принципиальная модель потоков

В архитектуре Mindstream потоки данных разделяются по их роли и происхождению. Потоки не образуют единого сквозного pipeline и не описывают локальные вычисления в браузере.

В системе различаются следующие классы потоков:

- **Corpus Formation Flows** — потоки формирования корпуса данных;
- **Corpus Delivery Flows** — потоки передачи корпусных данных в браузерный контур;
- **Attention Signal Flows** — потоки сигналов внимания.

![Data flow classes](../_img/mindstream_arch_data_flow_types.svg)

_Схема фиксирует классы потоков данных и их направленность между архитектурными контурами. Схема является якорной и не описывает реализационные детали._

В рамках **Corpus Delivery Flows** допускаются условные потоки доступа к профилю интересов пользователя, зависящие от режима доступа.

Локальные вычислительные петли браузерного контура не рассматриваются как потоки данных в архитектурном смысле и в данном документе не описываются.

---

## Потоки формирования корпуса данных

(**Corpus Formation Flows**)

Потоки формирования корпуса данных существуют исключительно в контурах формирования корпуса и относятся к серверной части системы.

Эти потоки:

- формируют каноническое состояние корпуса данных;
- не зависят от пользовательского контекста;
- не имеют обратных связей с браузерными контурами;
- не пересматривают ранее сформированные данные реактивно.

Результатом данных потоков является общий корпус смысловых данных, используемый всеми пользовательскими контекстами.

Детализация данных потоков вынесена в отдельный документ.

---

## Потоки передачи корпусных данных

(**Corpus Delivery Flows**)

Потоки передачи корпусных данных соединяют каноническое состояние корпуса с браузерным контекстом пользователя.

Эти потоки:

- направлены от серверных контуров к браузерным;
- не изменяют состояние корпуса данных;
- не инициируют серверные вычисления;
- не являются реактивными.

Передача корпусных данных предоставляет браузеру доступ к уже сформированным данным для локального использования, но не влияет на upstream-контуры.

В рамках данных потоков может быть разрешён доступ к профилю интересов пользователя как к серверному состоянию при соответствующем режиме доступа.

Детализация потоков передачи вынесена в отдельный документ.

---

## Потоки сигналов внимания

(**Attention Signal Flows**)

Сигналы внимания возникают в браузерном контексте как результат пользовательского взаимодействия с персональной лентой и смысловыми представлениями публикаций.

Поток сигналов внимания:

- направлен от браузерных контуров к серверному контуру хранения;
- имеет статистический характер;
- допускается только при выполнении условий режима доступа;
- не инициирует пересчёт корпуса данных или смысловых представлений.

Передача сигналов внимания не является управляющим воздействием на систему.

Детализация потоков внимания вынесена в отдельный документ.

---

## Запрещённые и отсутствующие потоки

В архитектуре MVP Mindstream отсутствуют и архитектурно запрещены:

- сквозные pipeline, объединяющие серверные и браузерные контуры;
- глобальные обратные связи от пользовательского поведения к формированию корпуса;
- online-learning и реактивный пересчёт смысловых представлений;
- пользовательские управляющие потоки данных.

Любое появление таких потоков считается выходом за рамки MVP.

---

## Документы детализации

Детализация потоков данных выполняется в отдельных документах:

- `ctx/docs/architecture/data-flow/corpus.md` — **Corpus Formation Flows**;
- `ctx/docs/architecture/data-flow/transfer.md` — **Corpus Delivery Flows**;
- `ctx/docs/architecture/data-flow/attention.md` — **Attention Signal Flows**.

---

## Итог

Документ фиксирует модель потоков Mindstream как совокупность ограниченных по роли и направленности потоков, обеспечивающих формирование канонического корпуса данных и его локальную персональную проекцию без глобальной реактивности и управляющих обратных связей в рамках MVP.
