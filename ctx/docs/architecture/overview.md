# Mindstream — Architecture Overview

Path: `ctx/docs/architecture/overview.md`

## Назначение

Документ фиксирует архитектурную форму MVP Mindstream: какие архитектурные контуры составляют систему, где проходит граница между системой и внешней средой и какие архитектурные свойства считаются неизменяемыми в рамках MVP.

Документ описывает, что существует архитектурно, и какие формы взаимодействия между частями системы допустимы, не переходя к описанию реализаций, алгоритмов, технологий или пользовательских интерфейсов.

Архитектура выводится непосредственно из продуктового видения и ограничений MVP и не вводит новых продуктовых сущностей.

---

## Архитектурная позиция

Mindstream архитектурно представляет собой распределённую систему персональной смысловой проекции корпуса публикаций.

Система разделена на два класса архитектурных контуров с асимметричными ролями:

- контуры формирования корпуса, отвечающие за построение и поддержку общего канонического корпуса смысловых данных;
- контуры персональной проекции и внимания, отвечающие за локальное формирование персонального опыта чтения и фиксацию внимания пользователя в браузерном контексте.

Архитектура исключает глобальную реактивность и пересчёт корпуса данных в ответ на индивидуальные пользовательские действия в рамках MVP.

---

## Граница системы и внешняя среда

К системе Mindstream относятся:

- контуры формирования корпуса смысловых данных;
- контуры персональной проекции и внимания в пользовательском контексте браузера.

К внешней среде относятся:

- источники публикаций, из которых извлекается контент;
- LLM API и Embedding API как внешние вычислительные сервисы;
- сеть и инфраструктура выполнения.

Внешняя среда не обладает знанием о внутреннем устройстве Mindstream, не участвует в его жизненном цикле и не получает обратных сигналов от системы.

---

## Архитектурная схема

Ниже приведена обобщённая схема архитектурных контуров MVP Mindstream, иллюстрирующая границу системы, направленность потоков и распределение ролей между контурами.

![Mindstream architecture contours](../_img/mindstream_arch_conturs.svg)

Схема носит пояснительный характер и не фиксирует реализационные или технологические решения.

---

## Архитектурные контуры MVP

В рамках MVP архитектура Mindstream описывается через устойчивые архитектурные контуры, каждый из которых фиксирует роль и ответственность, а не конкретный механизм реализации.

### Контуры формирования корпуса

**Контур агрегации и подготовки публикаций (`Ingestion`)**  
Отвечает за получение публикаций из внешних источников и формирование допустимого для смысловой обработки текстового представления публикации. Подготовка включает извлечение значимого текста и его смысловую нормализацию как предпосылку формирования аннотаций и обзоров.

**Контур смысловой обработки (`Primary Processing`)**  
Формирует LLM-производные смысловые представления публикаций — аннотацию и обзор — как устойчивые алгоритмические проекции исходного текста. Эти представления не пересматриваются реактивно и используются как базовые смысловые артефакты системы.

**Embedding-контур (`Embedding`)**  
Формирует эмбеддинги исключительно для аннотаций и обзоров публикаций. Эмбеддинги рассматриваются как архитектурные производные смысловых представлений и используются только для операций смыслового сопоставления и персональной проекции.

**Контур хранения корпуса и статистики (`Storage`)**  
Обеспечивает хранение публикаций, их смысловых представлений, эмбеддингов и агрегированной статистики внимания. Состояние данного контура является каноническим и инвариантным по отношению к отдельному пользователю и не пересчитывается в ответ на локальные пользовательские действия.

---

### Контуры персональной проекции и внимания

**Контур потребления (`Consumption`)**  
Отвечает за формирование и визуализацию персональной ленты как локальной персональной проекции доступного корпуса данных и за пользовательское чтение смысловых представлений публикаций.

**Контур сигналов внимания (`Attention Signals`)**  
Фиксирует факты пользовательского внимания к публикациям в браузерном контексте. Сигналы внимания могут использоваться локально и, при соблюдении условий режима доступа, передаваться в серверный контур хранения исключительно как статистические данные.

**Контур профиля интересов (`Interest Profile`)**  
Формирует и использует interest vector как локальную производную, применяемую при вычислении персональной ленты.

Источник interest vector зависит от режима доступа пользователя:

- в демо-режиме interest vector формируется и поддерживается локально в браузерном контуре на основе демонстрационного корпуса и локальных сигналов внимания и не синхронизируется с сервером;
- в режиме полного доступа interest vector может быть получен из серверного контура хранения как часть канонического состояния профиля пользователя и использоваться в браузере как входное состояние для персональной проекции.

Контуры персональной проекции и внимания допускают наличие локального состояния браузера, используемого для накопления предпочтений и формирования персональной ленты, однако это состояние не образует самостоятельного архитектурного контура хранения и не рассматривается как каноническое.

Локальные пересчёты персональной ленты и профиля интересов не приводят к изменению состояния контуров формирования корпуса и не влияют на другие пользовательские контексты.

---

## Направленность потоков и обратные связи

Архитектура Mindstream предполагает:

- однонаправленное формирование корпуса смысловых данных в контурах формирования корпуса;
- отсутствие реактивного пересчёта аннотаций, обзоров и эмбеддингов в ответ на пользовательское поведение;
- локальные обратные связи между сигналами внимания и персональной лентой в браузерных контурах;
- отсутствие глобальных обратных связей между контурами персональной проекции и состоянием корпуса данных.

Любые формы online-learning, глобального обучения или пересчёта прошлого архитектурно исключены в рамках MVP.

---

## Архитектурные инварианты MVP

В рамках MVP считается истинным, что:

- корпус смысловых данных формируется централизованно и используется всеми пользователями;
- персональная лента является локальной производной и не существует как глобальная сущность;
- эмбеддинги формируются только для аннотаций и обзоров;
- состояние контуров формирования корпуса является каноническим и инвариантным по отношению к отдельному пользователю;
- пользователь не является архитектурным источником управляющих событий и выступает только источником сигналов внимания;
- глобальные реактивные обратные связи отсутствуют.

Нарушение любого из этих свойств означает выход за рамки MVP.

---

## Границы документа

Данный overview не описывает:

- конкретные источники публикаций и способы их получения;
- форматы хранения и передачи данных;
- алгоритмы расчёта смысловой близости;
- пользовательский интерфейс и визуальную форму ленты;
- инженерные и эксплуатационные решения.

Эти вопросы относятся к последующим слоям документации.

---

## Итог

Документ фиксирует архитектуру Mindstream как распределённую систему персональной смысловой проекции, в которой контуры формирования корпуса создают и поддерживают общий канонический корпус данных, а контуры персональной проекции и внимания локально формируют персональный опыт чтения и фиксируют внимание пользователя при строгом разделении ролей, направленности потоков и отсутствии глобальной реактивности в рамках MVP.
