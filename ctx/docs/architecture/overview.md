# Mindstream — Architecture Overview

Path: `ctx/docs/architecture/overview.md`

## Назначение

Документ фиксирует архитектурную форму MVP Mindstream: какие архитектурные контуры составляют систему, где проходит граница между системой и внешней средой и какие архитектурные свойства считаются неизменяемыми в рамках MVP.

Документ описывает, что существует архитектурно, и какие формы взаимодействия между частями системы допустимы, не переходя к описанию реализаций, алгоритмов, технологий или пользовательских интерфейсов.

Архитектура выводится непосредственно из продуктового видения и ограничений MVP и не вводит новых продуктовых сущностей.

---

## Архитектурная позиция

Mindstream архитектурно представляет собой распределённую систему персональной смысловой проекции корпуса публикаций.

Система разделена на два класса архитектурных контуров с асимметричными ролями:

- контуры формирования корпуса, отвечающие за построение и поддержку общего канонического корпуса смысловых данных;
- контуры персональной проекции и внимания, отвечающие за локальное формирование персонального опыта чтения и фиксацию внимания пользователя в браузерном контексте.

---

## Граница системы и внешняя среда

К системе Mindstream относятся:

- контуры формирования корпуса смысловых данных;
- контуры персональной проекции и внимания в пользовательском браузерном контексте.

К внешней среде относятся:

- источники публикаций;
- LLM API и Embedding API как внешние вычислительные сервисы;
- сеть и инфраструктура исполнения;
- пользовательские клиенты и операционная среда запуска.

### Ingress-границы системы

Взаимодействие внешней среды с системой Mindstream осуществляется **исключительно через архитектурно зафиксированные ingress-границы**:

- **HTTP Ingress** — внешний веб-вход для сервисов, доступных из браузерного и иного HTTP-контекста;
- **CLI Ingress** — внешний операционный вход для batch- и обслуживающих команд.

Оба ingress-канала считаются внешними по отношению к архитектурным контурам системы и не являются частью доменной логики или контуров обработки данных.

---

## Архитектурная схема

Ниже приведена обобщённая схема архитектурных контуров MVP Mindstream, иллюстрирующая границу системы, направленность потоков и распределение ролей между контурами.

![Mindstream architecture contours](../_img/mindstream_arch_conturs.svg)

Схема носит пояснительный характер и не фиксирует реализационные или технологические решения.

---

## Архитектурные контуры MVP

В рамках MVP архитектура Mindstream описывается через устойчивые архитектурные контуры, каждый из которых фиксирует роль и ответственность, а не конкретный механизм реализации.

### Контуры формирования корпуса

**Контур агрегации и подготовки публикаций (`Ingestion`)**

Отвечает за получение публикаций из внешних источников и формирование допустимого для смысловой обработки текстового представления публикации.

**Контур смысловой обработки (`Primary Processing`)**

Формирует LLM-производные смысловые представления публикаций — аннотацию и обзор — как устойчивые алгоритмические проекции исходного текста.

**Embedding-контур (`Embedding`)**

Формирует эмбеддинги исключительно для аннотаций и обзоров публикаций как архитектурные производные смысловых представлений.

**Контур хранения корпуса и статистики (`Storage`)**

Обеспечивает хранение публикаций, их смысловых представлений, эмбеддингов и агрегированной статистики внимания. Состояние данного контура является каноническим.

---

### Контуры персональной проекции и внимания

**Контур потребления (`Consumption`)**

Отвечает за формирование и визуализацию персональной ленты как локальной персональной проекции доступного корпуса данных.

**Контур сигналов внимания (`Attention Signals`)**

Фиксирует факты пользовательского внимания в браузерном контексте и, при выполнении условий режима доступа, передаёт их в серверный контур хранения как статистические данные.

**Контур профиля интересов (`Interest Profile`)**

Формирует и использует interest vector как локальную производную, применяемую при вычислении персональной ленты. Источник interest vector зависит от режима доступа пользователя.

Локальные пересчёты персональной ленты и профиля интересов не приводят к изменению состояния контуров формирования корпуса и не влияют на другие пользовательские контексты.

---

## Направленность потоков и обратные связи

Архитектура Mindstream предполагает:

- однонаправленное формирование корпуса смысловых данных в серверных контурах;
- отсутствие реактивного пересчёта корпуса в ответ на пользовательское поведение;
- локальные статистические зависимости между сигналами внимания и персональной лентой;
- отсутствие глобальных обратных связей между пользовательскими контурами и состоянием корпуса данных.

Ограничения потоков, запреты на реактивность и обратные связи зафиксированы в `ctx/docs/architecture/data-flow.md`.

---

## Архитектурные инварианты MVP

В рамках MVP считается истинным, что:

- корпус смысловых данных формируется централизованно и используется всеми пользователями;
- персональная лента является локальной производной и не существует как глобальная сущность;
- эмбеддинги формируются только для аннотаций и обзоров;
- состояние контуров формирования корпуса является каноническим;
- пользователь не является архитектурным источником управляющих событий.

Нарушение любого из этих свойств означает выход за рамки MVP.

---

## Границы документа

Данный overview не описывает конкретные источники публикаций и способы их получения, форматы хранения и передачи данных, алгоритмы расчёта смысловой близости, пользовательский интерфейс и визуальную форму ленты, а также инженерные и эксплуатационные решения.

Эти вопросы относятся к последующим слоям документации.

---

## Статус ingress-документов

Документы:

- `ctx/docs/architecture/http-ingress.md`
- `ctx/docs/architecture/cli-ingress.md`

фиксируют архитектурные решения уровня MVP. Изменение их инвариантов требует пересмотра архитектурного корпуса документации.

---

## Итог

Документ фиксирует архитектуру Mindstream как систему с жёстко разделёнными контурами формирования корпуса и персональной проекции, с явно зафиксированными ingress-границами взаимодействия с внешней средой и с отсутствием глобальной реактивности в рамках MVP.
