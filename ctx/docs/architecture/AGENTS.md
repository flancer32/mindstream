# Architecture Layer — AGENTS

Path: `ctx/docs/architecture/AGENTS.md`

## Назначение

Данный документ определяет **границы и правила архитектурного слоя**
документации проекта Mindstream.

Архитектурный слой фиксирует **форму системы**:  
как она развернута, из каких контуров состоит,  
какие потоки данных допустимы и какие архитектурные свойства считаются инвариантами.

Архитектура описывает **что существует и как связано**,  
но не объясняет, _как это реализуется_.

---

## Карта уровня

Слой `architecture/` включает:

- `overview.md` — архитектурная форма системы, контуры и границы;
- `data-flow.md` — движение данных между архитектурными контурами;
- `AGENTS.md` — текущий документ, определяющий границы слоя.

Другие документы в этом слое могут появляться
только для уточнения архитектурной формы,
без перехода к реализации или UI.

---

## Область ответственности слоя

Архитектурный слой отвечает за:

- фиксацию формы развёртывания системы (client / backend / внешняя среда);
- явное определение контуров системы и их ролей;
- проведение границы между системой и внешней средой;
- описание допустимых потоков данных;
- закрепление архитектурных инвариантов MVP.

Архитектурный слой **не отвечает** за:

- продуктовые смыслы и терминологию;
- MVP-ограничения и приоритеты;
- пользовательский интерфейс и композицию;
- алгоритмы, формулы и модели расчётов;
- инженерные, технологические и эксплуатационные решения.

---

## Инварианты архитектурного слоя

В рамках архитектурной документации считается истинным, что:

- архитектура Mindstream описывается как **однопроходный pipeline**;
- все потоки данных **однонаправленные**;
- состояние системы **монотонно накапливается**;
- отсутствуют обратные связи, циклы и реактивное поведение;
- LLM и внешние источники являются **частью внешней среды**, а не системы;
- embeddings являются **архитектурной подсистемой**, но не семантической платформой;
- consume-контур не изменяет архитектурное состояние.

Эти свойства не подлежат интерпретации или ослаблению
на последующих уровнях документации.

---

## Правила для агента

При работе с документами слоя `architecture/` агент обязан:

- не вводить новые контуры, не зафиксированные в overview;
- не описывать алгоритмы, формулы и оптимизации;
- не использовать терминологию UI и пользовательских сценариев;
- не ссылаться на конкретные технологии, протоколы и библиотеки;
- трактовать архитектурные инварианты буквально;
- останавливать рассуждения, ведущие к реактивной или state-driven архитектуре.

Запрещено:

- подменять архитектурные потоки инженерными пайплайнами;
- обсуждать “как удобнее реализовать”;
- вводить future-proofing и заделы на расширение вне MVP;
- дублировать ограничения из `constraints/`.

---

## Связи с другими слоями

- `product/` задаёт смысл и язык, которым пользуется архитектура.
- `constraints/` имеют **приоритет** над архитектурой и ограничивают допустимую форму.
- `composition/` использует результаты архитектуры,
  но не влияет на неё.
- `code/` и `environment/` реализуют архитектуру,
  но не вправе её интерпретировать или расширять.

При конфликте утверждений
**архитектура подчиняется constraints**.

---

## Итог

`ctx/docs/architecture/AGENTS.md` фиксирует архитектурный слой
как **уровень формы и связей**,  
отделяющий продуктовый смысл от реализации
и защищающий MVP Mindstream
от дрейфа в сторону реактивных, stateful или объяснительных систем.
