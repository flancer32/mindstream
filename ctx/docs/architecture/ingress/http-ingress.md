# HTTP Ingress

Path: `./ctx/docs/architecture/ingress/http-ingress.md`

## Назначение

**HTTP Ingress** — инфраструктурная архитектурная граница Mindstream, через которую система принимает все внешние HTTP-запросы из веб-контекста и иных HTTP-клиентов.

HTTP Ingress принимает только read/write запросы и передаёт их во внутреннее backend-приложение без принятия доменных решений, генерации идентификаторов или управления состоянием.

---

## Границы ответственности

HTTP Ingress отвечает за:

- приём внешних HTTP-запросов;
- передачу управления во внутреннее backend-приложение;
- обеспечение единой и контролируемой HTTP-границы системы.

HTTP Ingress **не отвечает** за:

- доменную логику обработки данных;
- управление жизненным циклом сущностей;
- хранение и интерпретацию данных;
- генерацию UUID;
- аутентификацию, авторизацию и роли.

---

## Архитектурные инварианты (MVP)

В рамках MVP зафиксированы следующие inbound-инварианты:

1. **Apache является обязательным компонентом runtime-контура.** Все внешние HTTP-запросы к системе проходят через Apache.
2. **Прямой внешний доступ к Node-приложению недопустим.** Node-приложение не экспонируется напрямую во внешнюю сеть. Прямой доступ допустим только в dev- или тестовых контурах.
3. **HTTP Ingress канонически реализован через `@flancer32/teq-web`.** Dispatcher-модель `@flancer32/teq-web` (pre / process / post) является частью архитектурного инварианта MVP. Альтернативные HTTP-входы или библиотеки не предусматриваются.

---

## Read/Write границы

HTTP Ingress:

- принимает только read/write запросы;
- не является каналом batch- или операционных команд;
- не расширяет архитектурные контуры за пределы ingress.

---

## Anonymous Identity и HTTP Ingress

В рамках MVP HTTP Ingress работает только с **anonymous identity** как техническим идентификатором источника write-сигналов.

HTTP Ingress:

- **не генерирует UUID**;
- **не управляет lifecycle identity**;
- **не интерпретирует identity как субъекта**;
- **не реализует аутентификацию или авторизацию**.

Write-операции, требующие идентификации источника, допускаются **только при наличии зарегистрированной anonymous identity**. Запросы без зарегистрированной identity считаются архитектурно недопустимыми для соответствующих write-путей.

---

## Контекст использования

HTTP Ingress предназначен для:

- доставки read-моделей в браузерный контекст;
- приёма write-событий статистического характера при выполнении архитектурных условий.

Форматы API, способы сериализации данных и реализация endpoint-обработчиков не фиксируются на архитектурном уровне.

---

## Связанные архитектурные документы

- `ctx/docs/architecture/anonymous-identity/invariants.md` — модель anonymous identity.
- `ctx/docs/architecture/ingress/attention-write-ingress.md` — write-ingress сигналов внимания.
- `ctx/docs/architecture/data-flow/attention.md` — Attention flows.

---

## Итог

HTTP Ingress фиксирует инфраструктурную HTTP-границу системы в MVP Mindstream, принимающую read/write запросы и сохраняющую изоляцию доменной логики, identity и хранения от внешнего доступа.
