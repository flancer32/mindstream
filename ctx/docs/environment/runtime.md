# Runtime Environment — MVP

Path: `./ctx/docs/environment/runtime.md`

## Назначение

Документ фиксирует **среду исполнения MVP Mindstream**.  
Он определяет допустимые платформы, рантаймы и внешние зависимости, в рамках
которых возможна реализация системы.

Документ не описывает архитектуру, композицию интерфейса и кодовые решения.

---

## Среда исполнения

- Серверная часть исполняется на **VPS**.
- Клиентская часть исполняется в **браузере пользователя**.
- Допускается наличие нескольких сред исполнения (например, dev / prod),
  отличающихся параметрами доступа и окружения.
- Ограничений по региону, провайдеру и операционной системе нет.

---

## Платформа выполнения

- Серверная платформа: **Node.js**.
- Клиентская платформа: **browser runtime**.
- Serverless-подходы не используются.
- Минимальная среда исполнения зафиксирована:
  - **Node.js LTS (целевой — 20.x)**;
  - **современные evergreen-браузеры**;
  - **PostgreSQL 16+**.

---

## Клиентская среда

- Клиент ориентирован на **PWA**, подход **mobile first**.
- Поддерживаются только **современные evergreen-браузеры**.
- Legacy-браузеры исключены.
- Offline-режим в MVP **исключён**.

---

## Хранение данных

- Серверное хранилище: **PostgreSQL**.
- Клиентское локальное хранилище: **IndexedDB**.
- Используется одно серверное хранилище для всех пользователей
  и одно локальное хранилище на пользователя.
- Данные разделяются по физическому размещению:
  - локальные — в IndexedDB;
  - удалённые — в PostgreSQL.

---

## Интеграции и внешние зависимости

- Внешние API допускаются **только для LLM**.
- SaaS-инфраструктура (auth, analytics, queues и т.п.) не используется.
- Количество зависимостей минимизируется.
- Все базовые (не транзитивные) зависимости подлежат согласованию с человеком.

---

## LLM и embeddings

- LLM используются **через API**.
- Используется библиотека **openai**.
- Провайдер LLM может быть любым, совместимым с API.
- Эмбеддинги хранятся:
  - на сервере — в PostgreSQL;
  - на клиенте — в IndexedDB.

---

## Масштаб и режим использования

- MVP рассчитан на **десятки и сотни пользователей**.
- Один браузер соответствует одному пользователю.
- Многопользовательский режим в одном браузере не предполагается.
- Жёсткие ограничения по памяти, CPU и latency не задаются.

---

## Безопасность и изоляция

- Пользовательские данные изолированы за счёт изолированности клиентских сред исполнения.
- Хранение чувствительных персональных данных не допускается.
- Compliance-ограничения отсутствуют.
- Собирается только анонимная статистика.

---

## Запрещённое

- **TypeScript** запрещён.
- Любые **реактивные фреймворки** запрещены, включая временное использование.
