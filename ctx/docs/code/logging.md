# Code Logging — MVP

Path: `./ctx/docs/code/logging.md`

## Назначение

Документ фиксирует **нормативные принципы логирования кодового слоя MVP Mindstream**.

Логирование рассматривается как **обязательный наблюдательный слой системы** (observability minimum), обеспечивающий воспроизводимую наблюдаемость исполнения кода без влияния на продуктовые данные, архитектурные потоки и поведение системы.

Документ относится исключительно к слою `code/` и не вводит архитектурных, продуктовых, композиционных или эксплуатационных решений.

---

## Статус логирования в MVP

В рамках MVP Mindstream считается истинным, что:

- логирование является **обязательным**;
- отсутствие логирования в местах значимых действий или ошибок считается **инженерным дефектом**;
- логирование не является опциональной диагностикой и не может быть исключено под предлогом MVP.

Логирование обеспечивает наблюдаемость исполнения, но не участвует в управлении системой.

---

## Статус логов как данных

Логи:

- допускаются как **внешний наблюдательный след исполнения**;
- **не являются частью данных продукта**;
- **не входят** в архитектурную модель данных Mindstream;
- **не используются системой** как источник истины, вход или механизм восстановления состояния.

Логи не относятся к:

- `Storage`;
- attention signals;
- агрегированной статистике внимания.

Использование логов как скрытого data-flow, обходного канала передачи данных или источника вычислений запрещено.

Удаление, недоступность или ротация логов не влияют на корректность работы системы.

---

## Уровни логирования

В MVP используется **строго фиксированный набор уровней логирования**:

- `debug`
- `info`
- `warn`
- `error`

Данный набор является нормативным.

- отсутствие уровня;
- использование произвольных уровней;
- подмена семантики уровней

считаются нарушением инженерной нормы кодового слоя.

---

## Метод `exception`

Для логирования исключений используется **отдельный метод `exception`**.

`exception`:

- не является alias-ом `error`;
- предназначен исключительно для логирования исключительных ситуаций;
- принимает **стандартный объект `Error` JavaScript**.

В рамках MVP используется **встроенный контракт `Error`**, без введения пользовательских или расширенных типов исключений.

При логировании `exception` обязано фиксироваться:

- `error.message`;
- `error.stack`;
- `error.cause` — при наличии.

Использование метода `error` для логирования объектов `Error` вместо `exception` считается нарушением семантики логирования.

---

## Namespace как обязательный контекст

Каждое лог-сообщение **обязано** содержать namespace.

- namespace передаётся **при каждом вызове логирования**;
- отсутствие namespace считается **инженерным дефектом**;
- логгер не хранит текущий namespace во внутреннем состоянии.

Логгер является **синглтоном области исполнения**:

- один экземпляр для frontend-контекста;
- один экземпляр для backend-контекста.

---

## Контракт входа и выхода логирования

### Вход логирования

Каждый вызов логирования принимает:

- `namespace`;
- `message` (string);
- произвольные дополнительные аргументы.

### Выход логирования

Выход логирования является **минимально структурированным** и включает:

- timestamp;
- level;
- namespace;
- message;
- дополнительные аргументы.

Конкретный формат сериализации не фиксируется до байтового уровня, но наличие указанных компонентов является нормативным.

---

## Платформенная нейтральность

`Mindstream_Shared_Logger` относится к зоне `Mindstream_Shared_` и считается **platform-agnostic**.

- логгер не использует platform API напрямую;
- вывод осуществляется через консольный механизм, предоставляемый средой исполнения;
- логгер не различает frontend и backend по поведению, только по области применения.

---

## Логирование и unit-тесты

В unit-тестах:

- допускается мокирование логгера заглушкой, не выполняющей действий;
- production-реализация логгера может не использоваться;
- код обязан вызывать логгер независимо от того, замокан он или нет.

Логирование не является частью проверяемого контракта тестов и не используется для assertions.

---

## Границы документа

Документ не описывает:

- реализацию логгера;
- форматы хранения логов;
- агрегацию, ротацию и доставку логов;
- интеграцию с внешними системами наблюдаемости;
- эксплуатационные процедуры.

Все перечисленные вопросы находятся вне рамок MVP и данного слоя документации.

---

## Итог

Документ фиксирует логирование в MVP Mindstream как обязательный, платформенно-независимый наблюдательный слой кодовой базы с жёстко заданной семантикой уровней, явным использованием стандартного объекта `Error` и строгим требованием к namespace, без превращения логов в данные продукта или архитектурный механизм.
