# Source Code — AGENTS

Path: `./src/AGENTS.md`

## Назначение

Документ определяет **процедурные требования к работе агента с production-кодом проекта Mindstream**, размещённым в каталоге `src/`.

Документ применяется ко всем подкаталогам `src/` и дополняет правила, зафиксированные в корневом `AGENTS.md` и в документации контекста (`ctx/`).

Документ не фиксирует инженерные инварианты кода и не дублирует правила, описанные в `ctx/docs/code/`.

---

## Карта уровня

- `src/` — исходный production-код backend'а в проекте Mindstream.
- `AGENTS.md` — текущий документ; процедурные требования к действиям агента при изменении кода данного уровня.

---

## Границы ответственности агента

В каталоге `src/` агент:

- изменяет production-код backend и shared-слоёв;
- обязан соблюдать все инженерные инварианты, зафиксированные в `ctx/docs/code/`;
- действует исключительно в рамках DI-модели проекта;
- не расширяет scope продукта без явного указания человека.

Документ не описывает архитектуру, тестовую модель и структуру кода, а фиксирует **обязательные действия агента** при работе с исходниками.

---

## Требование выполнения тестов

Любое изменение production-кода в каталоге `src/` требует обязательной проверки unit-тестами.

Агент обязан:

- после внесения изменений выполнить команду `npm run test:unit`;
- убедиться, что тесты завершились без ошибок;
- зафиксировать факт выполнения тестов и их результат в отчёте итерации.

---

## Поведение при сбое тестов

Если выполнение `npm run test:unit` завершается с ошибками, агент обязан:

- не считать задачу завершённой;
- либо исправить код и повторно запустить тесты;
- либо явно зафиксировать причину сбоя в отчёте итерации и передать решение человеку.

Внесение изменений в production-код без успешного выполнения тестов считается некорректным.

---

## Запрещённые действия

В каталоге `src/` агенту запрещено:

- вносить изменения в production-код без последующего запуска unit-тестов;
- заявлять о завершении задачи при наличии падающих тестов;
- обходить или игнорировать тестовую инфраструктуру проекта;
- подменять проверку тестами субъективной оценкой корректности кода.

---

## Итоговое требование

Изменения production-кода в `src/` **не считаются валидными**, если они не подтверждены успешным выполнением `npm run test:unit` и не отражены в отчёте итерации.
